<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ejercicios Objeto Location y Navigator</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
    <script type="text/javascript">
        let nuevaVentana;
        let intervalId = null; // Variable para almacenar el ID de un intervalo (no usada en este fichero).
        let zoomLevel = 15; // Nivel de zoom inicial para el mapa de Google.

        // --- FUNCIONES PARA EL OBJETO LOCATION ---

        /**
         * EJERCICIO 2: Muestra las principales propiedades del objeto 'location'.
         * El objeto 'location' contiene información sobre la URL actual.
         */
        function mostrarPropiedadesLocation() {
            const loc = window.location; // Obtenemos el objeto 'location' de la ventana actual.
            // Creamos un string con formato HTML para mostrar las propiedades.
            const propiedades = ` 
                - <b>hash:</b> ${loc.hash} <br>
                - <b>host:</b> ${loc.host} <br>
                - <b>hostname:</b> ${loc.hostname} <br>
                - <b>href:</b> ${loc.href} <br>
                - <b>pathname:</b> ${loc.pathname} <br>
                - <b>port:</b> ${loc.port} <br>
                - <b>protocol:</b> ${loc.protocol} <br>
                - <b>search:</b> ${loc.search}`;
            // Insertamos el texto en el elemento con id="text".
            document.getElementById("text").innerHTML = "Propiedades del objeto <code>location</code>:<br>" + propiedades;
        }

        /**
         * EJERCICIO 3 y 4: Carga una nueva URL usando el método assign().
         * Este método navega a la URL indicada y guarda la página actual en el historial.
         */
        function cargarNuevaURL() {
            // Obtenemos la URL del campo de texto, o usamos una por defecto si está vacío.
            const url = document.getElementById("urlInput").value || "https://www.iesplayamar.es";
            if (url) {
                location.assign(url); // Navega a la nueva URL.
            }
        }

        /**
         * EJERCICIO 5: Recarga la página actual usando el método reload().
         */
        function recargarPagina() {
            location.reload(); // Recarga la página. Es como pulsar F5.
        }

        /**
         * EJERCICIO 6: Reemplaza la URL actual por una nueva usando replace().
         * Este método navega a la URL indicada SIN guardar la página actual en el historial.
         */
        function reemplazarURL() {
            // Obtenemos la URL del campo de texto, o usamos una por defecto si está vacío.
            const url = document.getElementById("urlInput").value || "https://www.iesplayamar.es";
            if (url) {
                location.replace(url); // Reemplaza la URL actual. No se puede volver atrás con el botón del navegador.
            }
        }

        /**
         * EJERCICIO 7: Muestra una explicación de la diferencia entre replace() y assign().
         */
        function diferenciaReplaceAssign() {
            const info = `
                <b>replace():</b> Cambia la URL actual sin guardar la página anterior en el historial del navegador.<br>
                <b>assign():</b> Cambia la URL actual y guarda la página anterior en el historial del navegador.`;
            // Muestra la información en el elemento con id="text".
            document.getElementById("text").innerHTML = info;
        }

        // --- FUNCIONES PARA EL OBJETO NAVIGATOR ---

        /**
         * EJERCICIO 8: Muestra las propiedades del objeto 'navigator'.
         * El objeto 'navigator' contiene información sobre el navegador del usuario.
         */
        function mostrarPropiedadesNavigator() {
            const nav = window.navigator; // Obtenemos el objeto 'navigator'.
            // Creamos un string HTML para mostrar las propiedades.
            const propiedades = ` 
                - <b>appCodeName:</b> ${nav.appCodeName} <br>
                - <b>appName:</b> ${nav.appName} <br>
                - <b>appVersion:</b> ${nav.appVersion} <br>
                - <b>cookieEnabled:</b> ${nav.cookieEnabled} <br>
                - <b>platform:</b> ${nav.platform} <br>
                - <b>userAgent:</b> ${nav.userAgent}`;
            // Insertamos el texto en el elemento con id="text".
            document.getElementById("text").innerHTML = "Propiedades del objeto <code>navigator</code>:<br>" + propiedades;
        }

        /**
         * EJERCICIO 9: Obtiene y muestra la geolocalización del usuario.
         * Utiliza la API de Geolocalización del navegador.
         */
        function obtenerGeolocalizacion() {
            const demo = document.getElementById("text");
            // Comprobamos si el navegador soporta la geolocalización.
            if (navigator.geolocation) {
                // Si la soporta, pedimos la posición actual.
                navigator.geolocation.getCurrentPosition(
                    (position) => { // Función que se ejecuta si se obtiene la posición con éxito.
                        demo.innerHTML = `Tu ubicación:<br>
                            <b>Latitud:</b> ${position.coords.latitude}<br>
                            <b>Longitud:</b> ${position.coords.longitude}`;
                    },
                    (error) => { // Función que se ejecuta si hay un error.
                        demo.textContent = "Error al obtener la geolocalización: " + error.message;
                    }
                );
            } else {
                // Si el navegador no soporta la geolocalización.
                demo.textContent = "La geolocalización no es soportada por este navegador.";
            }
        }

        /**
         * EJERCICIO 10: Carga un mapa de Google Maps en un iframe.
         * Usa coordenadas fijas y el nivel de zoom de la variable global 'zoomLevel'.
         */
        function cargarMapa() {
            const iframe = document.getElementById("mapaFrame");
            if (!iframe) return;
            const lat = 36.643675;
            const lon = -4.4902875;
            iframe.src = `https://maps.google.com/maps?q=${lat},${lon}&z=${zoomLevel}&output=embed`;
        }

        /**
         * EJERCICIO 11: Cambia el nivel de zoom del mapa.
         * @param {number} cantidad - El valor a sumar o restar al zoom actual (ej: 1 o -1).
         */
        function cambiarZoom(cantidad) {
            zoomLevel += cantidad;
            if (zoomLevel < 1) zoomLevel = 1;
            if (zoomLevel > 21) zoomLevel = 21;
            cargarMapa();
        }

        /**
         * FUNCIÓN DE CONFIGURACIÓN: Prepara la interfaz para el ejercicio seleccionado.
         * Esta función genera dinámicamente los botones y elementos necesarios para cada ejercicio.
         * @param {number} num - El número del ejercicio a mostrar.
         */
        function setupEjercicio(num) {
            const controlesDiv = document.getElementById("controles-ejercicio");
            const titulo = document.getElementById("titulo-ejercicio");
            const textoResultado = document.getElementById("text");
            textoResultado.innerHTML = "";

            let htmlControles = "";

            // Generamos los controles HTML según el ejercicio seleccionado en el menú desplegable.
            switch (num) {
                case 1:
                    titulo.textContent = "Ejercicio 2 - Propiedades de Location";
                    htmlControles = `<button onclick="mostrarPropiedadesLocation()" class="btn btn-info">Mostrar Propiedades de Location</button>`;
                    break;
                case 2:
                    titulo.textContent = "Ejercicio 3, 4, 5 y 6 - Métodos de Location";
                    htmlControles = `<div class="input-group mb-3">
                                        <input type="text" id="urlInput" class="form-control" placeholder="Introduce una URL (ej: https://www.google.com)">
                                     </div>
                                     <button onclick="cargarNuevaURL()" class="btn btn-primary me-2">Cargar con assign()</button>
                                     <button onclick="reemplazarURL()" class="btn btn-warning me-2">Cargar con replace()</button>
                                     <button onclick="recargarPagina()" class="btn btn-success">Recargar con reload()</button>`;
                    break;
                case 3:
                    titulo.textContent = "Ejercicio 7 - Diferencia entre replace() y assign()";
                    htmlControles = `<button onclick="diferenciaReplaceAssign()" class="btn btn-info">Mostrar Diferencia</button>`;
                    break;
                case 4:
                    titulo.textContent = "Ejercicio 8 - Propiedades de Navigator";
                    htmlControles = `<button onclick="mostrarPropiedadesNavigator()" class="btn btn-info">Mostrar Propiedades de Navigator</button>`;
                    break;
                case 5:
                    titulo.textContent = "Ejercicio 9 - Geolocalización";
                    htmlControles = `<button onclick="obtenerGeolocalizacion()" class="btn btn-info">Obtener mi Ubicación</button>`;
                    break;
                case 6:
                    titulo.textContent = "Ejercicio 10 y 11 - Google Maps con Iframe";
                    htmlControles = `<div class="w-100 text-center">
                                        <div class="btn-group mb-3" role="group">
                                            <button onclick="cambiarZoom(1)" class="btn btn-success">Aumentar Zoom (+)</button>
                                            <button onclick="cambiarZoom(-1)" class="btn btn-danger">Minimizar Zoom (-)</button>
                                        </div>
                                        <iframe id="mapaFrame" width="100%" height="450" style="border:0;" allowfullscreen="" loading="lazy"></iframe>
                                     </div>`;
                    // Cargar el mapa inmediatamente al seleccionar el ejercicio
                    setTimeout(cargarMapa, 0);
                    break;
            }
            controlesDiv.innerHTML = htmlControles;
        }

        /**
         * FUNCIÓN DE INICIO: Se ejecuta cuando la página ha cargado completamente.
         * Llama a setupEjercicio para mostrar el primer ejercicio por defecto.
         */
        function inicializar() {
            setupEjercicio(parseInt(document.getElementById('select-ejercicio').value));
        }
    </script>
</head>
<body onload="inicializar()"> <!-- El evento 'onload' llama a la función 'inicializar' cuando la página se carga. -->
    <div class="container mt-4">
        <header class="p-3 mb-4 bg-light rounded-3">
            <h1 class="display-5">Ejercicios con los Objetos Location y Navigator</h1>
            <p class="lead">Selecciona un ejercicio del menú para ver su funcionamiento.</p>
        </header>

        <div class="mb-4">
            <label for="select-ejercicio" class="form-label fw-bold">Seleccionar Ejercicio:</label>
            <select id="select-ejercicio" class="form-select w-auto" onchange="setupEjercicio(parseInt(this.value))"> <!-- El evento 'onchange' llama a setupEjercicio cada vez que se cambia la opción. -->
                <option value="1">Ejercicio 2: Propiedades de Location</option>
                <option value="2">Ejercicio 3, 4, 5 y 6: Métodos de Location</option>
                <option value="3">Ejercicio 7: Diferencia entre replace() y assign()</option>
                <option value="4">Ejercicio 8: Propiedades de Navigator</option>
                <option value="5">Ejercicio 9: Geolocalización</option>
                <option value="6">Ejercicio 10: Google Maps</option>
            </select>
        </div>

        <div class="card">
            <div class="card-header">
                <h2 id="titulo-ejercicio" class="h4 mb-0"></h2>
            </div>
            <div class="card-body">
                <div id="controles-ejercicio" class="d-flex flex-wrap justify-content-center align-items-center mb-3">
                </div>
                <div class="d-flex justify-content-center mt-3">
                    <p><span id="text" class="fw-bold"></span></p>
                </div>
            </div>
        </div>
    </div>
</body>
</html>